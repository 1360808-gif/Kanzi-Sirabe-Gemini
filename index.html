<!DOCTYPE html>
<html lang="ja">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>ã‹ã‚“ã˜ãƒ»ã§ã‹è¾æ›¸ï¼ˆãƒªã‚¢ãƒ«ã‚¿ã‚¤ãƒ ç‰ˆï¼‰</title>
    <style>
        :root {
            --primary-font: "UD Digi Kyokasho N-R", "UD Digi Kyokasho NK-R", "UDãƒ‡ã‚¸ã‚¿ãƒ«æ•™ç§‘æ›¸ä½“ N-R", "Klee One", "Zen Maru Gothic", sans-serif;
            --main-bg: #f5f8fa;
            --accent-orange: #e67e22;
            --sub-blue: #3498db;
        }

        body { font-family: var(--primary-font); background-color: var(--main-bg); margin: 0; display: flex; flex-direction: column; align-items: center; }

        /* å…¥åŠ›ã‚¨ãƒªã‚¢ */
        header { width: 100%; background: white; padding: 25px 0; box-shadow: 0 4px 15px rgba(0,0,0,0.08); position: sticky; top: 0; z-index: 100; }
        .search-box { max-width: 600px; margin: 0 auto; padding: 0 20px; }
        input[type="text"] {
            width: 100%; padding: 18px 28px; font-size: 26px; 
            border: 4px solid #e1e8ed; border-radius: 100px; 
            outline: none; font-family: var(--primary-font);
            transition: border-color 0.2s;
        }
        input[type="text"]:focus { border-color: var(--accent-orange); }

        /* çµæœã‚¨ãƒªã‚¢ */
        main { width: 95%; max-width: 1100px; padding: 30px 0; display: flex; flex-direction: column; align-items: center; gap: 25px; }

        /* ã€ãƒ¡ã‚¤ãƒ³ã€‘å…¥åŠ›ã—ãŸæ–‡å­— */
        .main-focus {
            background: white; width: 100%; max-width: 600px;
            padding: 40px; border-radius: 35px; border: 5px solid var(--accent-orange);
            box-shadow: 0 10px 25px rgba(0,0,0,0.1); text-align: center;
        }
        .huge-text { font-size: 140px; color: #1a202c; line-height: 1.3; }

        /* ã€ã‚µãƒ–ã€‘å€™è£œã‚¿ã‚¤ãƒ« */
        .sub-grid {
            display: grid; grid-template-columns: repeat(auto-fit, minmax(300px, 1fr));
            gap: 20px; width: 100%;
        }
        .sub-card {
            background: white; padding: 20px; border-radius: 20px;
            display: flex; align-items: center; gap: 20px;
            box-shadow: 0 4px 10px rgba(0,0,0,0.05); border-left: 10px solid var(--sub-blue);
            cursor: pointer; transition: transform 0.2s;
        }
        .sub-card:hover { transform: scale(1.02); }
        .sub-kanji { font-size: 55px; color: #2d3748; }
        .sub-info { font-size: 16px; color: #4a5568; line-height: 1.5; font-weight: bold; }

        ruby { ruby-align: center; }
        rt { font-size: 0.35em; color: var(--accent-orange); font-weight: bold; }
    </style>
</head>
<body>

<header>
    <div class="search-box">
        <input type="text" id="input-text" placeholder="ã“ã“ã« æ–‡å­—ã‚’ã„ã‚Œã¦ã­ï¼" autocomplete="off">
    </div>
</header>

<main id="result-area">
    </main>

<script>
    const dictionary = {
        "ã‹ã‚“ã˜": [
            {kanji:"æ¼¢å­—", r:"ã‹ã‚“ã˜", m:"æ—¥æœ¬ã® ä½¿ã† æ–‡å­—"},
            {kanji:"æ„Ÿã˜", r:"ã‹ã‚“ã˜", m:"å¿ƒã« ã†ã‹ã¶ æ°—æŒã¡"},
            {kanji:"å¹¹äº‹", r:"ã‹ã‚“ã˜", m:"ãƒ‘ãƒ¼ãƒ†ã‚£ãƒ¼ãªã©ã® ã¾ã¨ã‚å½¹"}
        ],
        "ã‚ã†": [
            {kanji:"ä¼šã†", r:"ã‚ã†", m:"äººã« ä¼šã†"},
            {kanji:"åˆã†", r:"ã‚ã†", m:"å½¢ã‚„ æ•°ãŒ åŒã˜ã«ãªã‚‹"},
            {kanji:"é­ã†", r:"ã‚ã†", m:"ã²ã©ã„ ç›®ã« é­ã†"}
        ],
        "ãã‹ã„": [
            {kanji:"æ©Ÿæ¢°", r:"ãã‹ã„", m:"ãƒã‚·ãƒ³ãƒ»ãƒ­ãƒœãƒƒãƒˆ"},
            {kanji:"æ©Ÿä¼š", r:"ãã‹ã„", m:"ãƒãƒ£ãƒ³ã‚¹ãƒ»ã¡ã‚‡ã†ã©ã‚ˆã„æ™‚"}
        ]
    };

    const input = document.getElementById('input-text');

    // å…¥åŠ›ã™ã‚‹ãŸã³ã«å‹•ãï¼ˆãƒªã‚¢ãƒ«ã‚¿ã‚¤ãƒ ï¼‰
    input.addEventListener('input', async () => {
        const val = input.value.trim();
        const area = document.getElementById('result-area');
        
        if(!val) {
            area.innerHTML = '<p style="color:#a0aec0; font-size:20px;">ğŸ” æ‰“ã¡è¾¼ã‚€ã¨ ã™ãã« ãŠæ‰‹æœ¬ãŒ å‡ºã‚‹ã‚ˆï¼</p>';
            return;
        }

        const hasKanji = /[ä¸€-é¾ ]/.test(val);
        let reading = hasKanji ? await fetchReading(val) : val;
        
        // --- è¡¨ç¤ºãƒ­ã‚¸ãƒƒã‚¯ ---
        let mainObj = { kanji: val, r: reading, m: "" };
        let suggestions = dictionary[reading] || [];

        // å…¥åŠ›ã—ãŸã‚‚ã®ãŒè¾æ›¸ã«ã‚ã‚‹ãªã‚‰ã€ãã®æ„å‘³ã‚’ãƒ¡ã‚¤ãƒ³ã«è¡¨ç¤º
        const dictMatch = suggestions.find(s => s.kanji === val);
        if(dictMatch) mainObj.m = dictMatch.m;

        // ãƒ¡ã‚¤ãƒ³ä»¥å¤–ã‚’ã‚µãƒ–å€™è£œã«ã™ã‚‹
        const subList = suggestions.filter(s => s.kanji !== val);

        render(mainObj, subList);
    });

    function render(main, subs) {
        const area = document.getElementById('result-area');
        
        // ãƒ¡ã‚¤ãƒ³ã‚«ãƒ¼ãƒ‰ã®HTML
        let html = `
            <div class="main-focus">
                <div style="color:#e67e22; font-weight:bold; margin-bottom:10px;">âœ¨ ã„ã¾ å…¥åŠ›ã—ã¦ã„ã‚‹ æ–‡å­—</div>
                <div class="huge-text">
                    <ruby>${main.kanji}<rt>${main.r}</rt></ruby>
                </div>
                <div style="font-size:22px; color:#4a5568; margin-top:15px; background:#fffaf0; padding:10px; border-radius:10px;">
                    ${main.m || 'ï¼ˆã˜ã—ã‚‡ã« ãªã„è¨€è‘‰ ã¾ãŸã¯ ç†Ÿèªã§ã™ï¼‰'}
                </div>
            </div>
        `;

        // ã‚µãƒ–å€™è£œï¼ˆã‚¿ã‚¤ãƒ«ï¼‰ã®HTML
        if(subs.length > 0) {
            html += `<div style="width:100%; font-weight:bold; color:#34495e; font-size:18px; margin-top:20px;">ğŸ’¡ ã»ã‹ã«ã¯ ã“ã‚“ãªæ¼¢å­—ã‚‚ ã‚ã‚‹ã‚ˆï¼š</div>`;
            html += `<div class="sub-grid">`;
            subs.forEach(item => {
                html += `
                    <div class="sub-card" onclick="setMain('${item.kanji}')">
                        <div class="sub-kanji"><ruby>${item.kanji}<rt>${item.r}</rt></ruby></div>
                        <div class="sub-info">${item.m}</div>
                    </div>
                `;
            });
            html += `</div>`;
        }

        area.innerHTML = html;
    }

    // å€™è£œã‚’ã‚¯ãƒªãƒƒã‚¯ã—ãŸã¨ã
    window.setMain = function(kanji) {
        input.value = kanji;
        // å…¥åŠ›ã‚¤ãƒ™ãƒ³ãƒˆã‚’æ‰‹å‹•ã§ç™ºç”Ÿã•ã›ã¦å†æç”»
        input.dispatchEvent(new Event('input'));
    };

    async function fetchReading(kanji) {
        try {
            const res = await fetch(`https://www.google.com/transliterate?langpair=ja|ja-Hira&text=${kanji}`);
            const data = await res.json();
            return data[0][1][0];
        } catch (e) { return ""; }
    }
</script>
</body>
</html>
