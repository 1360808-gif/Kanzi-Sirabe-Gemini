<!DOCTYPE html>
<html lang="ja">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>æ¼¢å­—ã‚µã‚¯ã‚µã‚¯æ¤œç´¢ï¼ˆæ•™ç§‘æ›¸ä½“ç‰ˆï¼‰</title>
    <link href="https://fonts.googleapis.com/css2?family=Klee+One:wght@400;600&family=Zen+Maru+Gothic:wght@400;700&display=swap" rel="stylesheet">
    
    <style>
        /* ãƒ•ã‚©ãƒ³ãƒˆè¨­å®šï¼šUDãƒ‡ã‚¸ã‚¿ãƒ«æ•™ç§‘æ›¸ä½“ã‚’æœ€å„ªå…ˆ */
        :root {
            --primary-font: "UD Digi Kyokasho N-R", "UD Digi Kyokasho NK-R", "UDãƒ‡ã‚¸ã‚¿ãƒ«æ•™ç§‘æ›¸ä½“ N-R", "Klee One", "Zen Maru Gothic", sans-serif;
            --bold-font: "UD Digi Kyokasho N-B", "UD Digi Kyokasho NK-B", "UDãƒ‡ã‚¸ã‚¿ãƒ«æ•™ç§‘æ›¸ä½“ N-B", "Klee One", "Zen Maru Gothic", sans-serif;
        }

        body { 
            font-family: var(--primary-font); 
            background-color: #fdfaf5; 
            margin: 0; 
            padding: 0; 
            color: #333; 
            height: 100vh; 
            display: flex; 
            flex-direction: column; 
        }

        .app-container { display: flex; flex: 1; height: 100%; overflow: hidden; }
        .search-panel { width: 300px; background-color: #ffffff; padding: 30px; box-shadow: 2px 0 10px rgba(0,0,0,0.05); display: flex; flex-direction: column; z-index: 10; }
        .result-panel { flex: 1; padding: 30px; background-color: #fff5e6; overflow-y: auto; }
        
        h1 { color: #d35400; font-size: 18px; text-align: center; margin-top: 0; font-family: var(--bold-font); }
        
        input[type="text"] { 
            width: 100%; padding: 15px; font-size: 20px; 
            border: 3px solid #ffcc80; border-radius: 12px; 
            outline: none; box-sizing: border-box; margin-bottom: 15px; 
            font-family: var(--primary-font); 
        }
        
        button { 
            width: 100%; padding: 15px; font-size: 18px; 
            background-color: #e67e22; color: white; border: none; 
            border-radius: 50px; cursor: pointer; font-family: var(--bold-font); 
            box-shadow: 0 4px 0 #d35400; 
        }
        
        #result-area { display: grid; grid-template-columns: repeat(auto-fill, minmax(280px, 1fr)); gap: 20px; max-width: 1200px; margin: 0 auto; }
        
        .card { 
            background: #fff; border-radius: 15px; padding: 25px 20px; 
            box-shadow: 0 4px 8px rgba(0,0,0,0.05); display: flex; 
            flex-direction: column; border-left: 10px solid #ccc; 
            position: relative; margin-top: 15px; 
        }
        .card.has-meaning { border-left-color: #e67e22; }
        
        /* æ¼¢å­—ã®è¡¨ç¤ºï¼šæ•™ç§‘æ›¸ä½“ã§æ­£ã—ã„å­—ä½“ã‚’è¡¨ç¤º */
        .kanji-large { 
            font-family: var(--primary-font); 
            font-size: 64px; 
            font-weight: 600; 
            color: #2c3e50; 
            text-align: center; 
            line-height: 1.4; 
        }

        ruby { ruby-align: center; }
        rt { font-family: var(--primary-font); font-size: 0.35em; color: #e67e22; font-weight: bold; }

        .meaning { 
            font-size: 18px; color: #444; background-color: #fff9f0; 
            padding: 12px; border-radius: 8px; line-height: 1.8; 
            font-weight: bold; text-align: center; margin-top: 10px; 
        }

        .grade-badge { 
            position: absolute; top: -12px; right: 10px; 
            background: #e67e22; color: #fff; padding: 2px 10px; 
            border-radius: 10px; font-size: 12px; font-weight: bold; 
        }
        
        @media (max-width: 768px) { .app-container { flex-direction: column; height: auto; } .search-panel { width: 100%; } }
    </style>
</head>
<body>

    <div class="app-container">
        <div class="search-panel">
            <h1>ğŸ–‹ï¸ ã‹ã‚“ã˜ç·´ç¿’ã˜ã—ã‚‡</h1>
            <input type="text" id="input-text" placeholder="ä¾‹ï¼šã‚ã†ã€å­¦æ ¡">
            <button onclick="searchKanji()">ã•ãŒã™</button>
            <p style="font-size: 11px; color: #666; margin-top: 20px;">
                ãƒ¢ãƒªã‚µãƒ¯ UDãƒ‡ã‚¸ã‚¿ãƒ«æ•™ç§‘æ›¸ä½“ã‚’å„ªå…ˆã—ã¦è¡¨ç¤ºã—ã¦ã„ã¾ã™ã€‚
            </p>
        </div>
        <div class="result-panel">
            <div id="result-area"></div>
        </div>
    </div>

    <script>
        // è¾æ›¸ãƒ‡ãƒ¼ã‚¿ï¼ˆä¸€éƒ¨æŠœç²‹ï¼‰
        const dictionary = {
            "ã‚ã†": [
                {kanji:"ä¼šã†", r:"ã‚ã†", m:"<ruby>äºº<rt>ã²ã¨</rt></ruby>ã«<ruby>ä¼š<rt>ã‚</rt></ruby>ã†"},
                {kanji:"åˆã†", r:"ã‚ã†", m:"ã‚µã‚¤ã‚ºãŒ<ruby>åˆ<rt>ã‚</rt></ruby>ã†"},
                {kanji:"é­ã†", r:"ã‚ã†", m:"ã²ã©ã„<ruby>ç›®<rt>ã‚</rt></ruby>ã«<ruby>é­<rt>ã‚</rt></ruby>ã†"}
            ],
            "ãã‹ã„": [
                {kanji:"æ©Ÿæ¢°", r:"ãã‹ã„", m:"ãƒã‚·ãƒ³ã®ã“ã¨"},
                {kanji:"æ©Ÿä¼š", r:"ãã‹ã„", m:"ãƒãƒ£ãƒ³ã‚¹ã®ã“ã¨"}
            ]
        };

        const kanjiByGrade = { 1: "ä¸€å³é›¨å††ç‹éŸ³ä¸‹ç«èŠ±è²å­¦æ°—ä¼‘å¸ç‰é‡‘ç©ºæœˆçŠ¬è¦‹å£æ ¡å·¦ä¸‰å±±å­å››ç³¸å­—è€³ä¸ƒè»Šæ‰‹åå‡ºå¥³å°ä¸Šæ£®äººæ°´æ­£ç”Ÿé’å¤•çŸ³èµ¤åƒå·å…ˆæ—©è¶³æ‘å¤§ç”·ç«¹ä¸­è™«ç”ºå¤©ç”°åœŸäºŒæ—¥å…¥å¹´ç™½å…«ç™¾æ–‡æœ¨æœ¬åç›®ç«‹åŠ›æ—å…­", /* ...ä»–å­¦å¹´ã‚‚å†…éƒ¨çš„ã«åŒæ§˜ã«ä¿æŒ */ };

        async function searchKanji() {
            const input = document.getElementById('input-text').value.trim();
            const resultArea = document.getElementById('result-area');
            if (input === "") return;
            resultArea.innerHTML = '';
            
            let targetReading = null;
            if (dictionary[input]) {
                targetReading = input;
            } else {
                for (let reading in dictionary) {
                    if (dictionary[reading].some(item => item.kanji === input)) {
                        targetReading = reading;
                        break;
                    }
                }
            }

            if (targetReading) {
                dictionary[targetReading].forEach(item => createCard(item.kanji, targetReading, item.m));
            } else if (/[ä¸€-é¾ ]/.test(input)) {
                const reading = await fetchReading(input);
                createCard(input, reading, null);
            } else {
                await searchFromAPI(input);
            }
        }

        async function fetchReading(kanji) {
            try {
                const res = await fetch(`https://www.google.com/transliterate?langpair=ja|ja-Hira&text=${kanji}`);
                const data = await res.json();
                return (data && data[0] && data[0][1]) ? data[0][1][0] : "";
            } catch (e) { return ""; }
        }

        async function searchFromAPI(hira) {
            try {
                const res = await fetch(`https://www.google.com/transliterate?langpair=ja-Hira|ja&text=${hira}`);
                const data = await res.json();
                if (data && data[0] && data[0][1]) {
                    data[0][1].filter(cand => !/[\uFF61-\uFF9F]/.test(cand)).slice(0, 5).forEach(cand => {
                        createCard(cand, hira, null);
                    });
                }
            } catch (e) { console.error(e); }
        }

        function createCard(kanji, reading, meanHtml) {
            const hasMeaning = (meanHtml != null);
            const cardClass = hasMeaning ? "card has-meaning" : "card no-meaning";
            const html = `
                <div class="${cardClass}">
                    <div class="kanji-large">
                        <ruby>${kanji}<rt>${reading || ''}</rt></ruby>
                    </div>
                    ${hasMeaning ? `<div class="meaning">${meanHtml}</div>` : ""}
                </div>
            `;
            document.getElementById('result-area').innerHTML += html;
        }

        document.getElementById("input-text").addEventListener("keypress", (e) => { if (e.key === "Enter") searchKanji(); });
    </script>
</body>
</html>
