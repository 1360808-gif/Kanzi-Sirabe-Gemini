<!DOCTYPE html>
<html lang="ja">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>ã‹ã‚“ã˜ãƒ»ã§ã‹è¾æ›¸ï¼ˆå…¥åŠ›å„ªå…ˆç‰ˆï¼‰</title>
    <style>
        :root {
            --primary-font: "UD Digi Kyokasho N-R", "UD Digi Kyokasho NK-R", "UDãƒ‡ã‚¸ã‚¿ãƒ«æ•™ç§‘æ›¸ä½“ N-R", "Klee One", "Zen Maru Gothic", sans-serif;
            --main-bg: #fdfaf5;
            --accent: #e67e22;
        }

        body {
            font-family: var(--primary-font);
            background-color: var(--main-bg);
            margin: 0;
            display: flex;
            flex-direction: column;
            align-items: center;
        }

        /* æ¤œç´¢ãƒãƒ¼ */
        header {
            width: 100%;
            background: white;
            padding: 20px 0;
            box-shadow: 0 4px 10px rgba(0,0,0,0.05);
            position: sticky;
            top: 0;
            z-index: 100;
        }

        .search-container {
            max-width: 600px;
            margin: 0 auto;
            display: flex;
            gap: 10px;
            padding: 0 20px;
        }

        input[type="text"] {
            flex: 1;
            padding: 15px 25px;
            font-size: 24px;
            border: 3px solid #ffcc80;
            border-radius: 50px;
            outline: none;
            font-family: var(--primary-font);
        }

        /* ãƒ¡ã‚¤ãƒ³è¡¨ç¤º */
        #result-area {
            width: 90%;
            max-width: 1000px;
            padding: 40px 0;
            display: flex;
            flex-direction: column;
            align-items: center;
            gap: 30px;
        }

        /* ã€Œã“ã‚Œï¼ã€ã¨ã„ã†ä¸€ç•ªå¤§ããªã‚«ãƒ¼ãƒ‰ */
        .focus-card {
            background: white;
            padding: 40px;
            border-radius: 30px;
            box-shadow: 0 15px 30px rgba(0,0,0,0.1);
            border: 4px solid var(--accent);
            text-align: center;
            width: 100%;
            max-width: 500px;
        }

        .focus-label {
            color: var(--accent);
            font-weight: bold;
            font-size: 16px;
            margin-bottom: 10px;
        }

        .huge-kanji {
            font-size: 140px;
            color: #2d3748;
            line-height: 1.2;
        }

        /* åŒéŸ³ç•°ç¾©èªã®ææ¡ˆã‚¨ãƒªã‚¢ */
        .other-suggestions {
            width: 100%;
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(280px, 1fr));
            gap: 20px;
        }

        .suggest-card {
            background: white;
            padding: 20px;
            border-radius: 20px;
            box-shadow: 0 4px 12px rgba(0,0,0,0.05);
            display: flex;
            align-items: center;
            gap: 20px;
            border-left: 8px solid #cbd5e0;
        }

        .suggest-kanji { font-size: 50px; color: #4a5568; }
        .suggest-info { flex: 1; }
        .suggest-mean { font-size: 14px; color: #718096; font-weight: bold; line-height: 1.4; }

        ruby { ruby-align: center; }
        rt { font-size: 0.3em; color: var(--accent); font-weight: bold; }
    </style>
</head>
<body>

<header>
    <div class="search-container">
        <input type="text" id="input-text" placeholder="ã—ã‚ŠãŸã„æ¼¢å­—ã‚’ã„ã‚Œã¦ã­" autocomplete="off">
    </div>
</header>

<div id="result-area">
    </div>

<script>
    const dictionary = {
        "ã‚ã†": [
            {kanji:"ä¼šã†", r:"ã‚ã†", m:"<ruby>äºº<rt>ã²ã¨</rt></ruby>ã« ä¼šã†"},
            {kanji:"åˆã†", r:"ã‚ã†", m:"<ruby>å½¢<rt>ã‹ãŸã¡</rt></ruby>ã‚„ <ruby>æ•°<rt>ã‹ãš</rt></ruby>ãŒ åŒã˜ã«ãªã‚‹"},
            {kanji:"é­ã†", r:"ã‚ã†", m:"ã²ã©ã„ <ruby>ç›®<rt>ã‚</rt></ruby>ã« é­ã†"}
        ],
        "ã‚ã¤ã„": [
            {kanji:"æš‘ã„", r:"ã‚ã¤ã„", m:"<ruby>æ°—æ¸©<rt>ããŠã‚“</rt></ruby>ãŒ æš‘ã„"},
            {kanji:"ç†±ã„", r:"ã‚ã¤ã„", m:"ãŠ<ruby>æ¹¯<rt>ã‚†</rt></ruby>ã‚„ <ruby>æ¸©åº¦<rt>ãŠã‚“ã©</rt></ruby>ãŒ ç†±ã„"},
            {kanji:"åšã„", r:"ã‚ã¤ã„", m:"<ruby>æœ¬<rt>ã»ã‚“</rt></ruby>ã‚„ <ruby>æ¿<rt>ã„ãŸ</rt></ruby>ãŒ åšã„"}
        ]
    };

    const input = document.getElementById('input-text');

    input.addEventListener('input', async () => {
        const val = input.value.trim();
        if(!val) {
            document.getElementById('result-area').innerHTML = '';
            return;
        }
        
        const hasKanji = /[ä¸€-é¾ ]/.test(val);
        let reading = hasKanji ? await fetchReading(val) : val;
        
        // å…¨å€™è£œã‚’å–å¾—
        let allCandidates = dictionary[reading] || [];
        
        // --- ã“ã“ãŒãƒã‚¤ãƒ³ãƒˆï¼šå…¥åŠ›ã•ã‚ŒãŸæ¼¢å­—ã‚’ä¸€ç•ªä¸Šã«ã™ã‚‹ ---
        let firstPriority = null;
        let others = [];

        if (hasKanji) {
            // å…¥åŠ›ã•ã‚ŒãŸæ¼¢å­—ãŒè¾æ›¸ã«ã‚ã‚‹ã‹æ¢ã™
            const foundInDict = allCandidates.find(item => item.kanji === val);
            if (foundInDict) {
                firstPriority = foundInDict;
                others = allCandidates.filter(item => item.kanji !== val);
            } else {
                // è¾æ›¸ã«ãªãã¦ã‚‚ã€å…¥åŠ›ã•ã‚ŒãŸæ¼¢å­—ãã®ã‚‚ã®ã‚’æœ€å„ªå…ˆã«ã™ã‚‹
                firstPriority = { kanji: val, r: reading, m: "ï¼ˆå…¥åŠ›ã—ãŸæ¼¢å­—ï¼‰" };
                others = allCandidates;
            }
        } else {
            // ã²ã‚‰ãŒãªå…¥åŠ›ã®å ´åˆã¯ã€è¾æ›¸ã®1ç•ªç›®ã‚’å„ªå…ˆ
            if (allCandidates.length > 0) {
                firstPriority = allCandidates[0];
                others = allCandidates.slice(1);
            }
        }

        renderUI(firstPriority, others);
    });

    function renderUI(main, subList) {
        const area = document.getElementById('result-area');
        area.innerHTML = '';

        if (!main) return;

        // 1. æœ€å„ªå…ˆï¼ˆå…¥åŠ›ã—ãŸæ¼¢å­—ï¼‰ã‚’å¤§ããè¡¨ç¤º
        const mainHtml = `
            <div class="focus-card">
                <div class="focus-label">âœ¨ ã„ã¾ å…¥åŠ›ã—ãŸ ã‹ã‚“ã˜</div>
                <div class="huge-kanji">
                    <ruby>${main.kanji}<rt>${main.r}</rt></ruby>
                </div>
                <div style="font-size:20px; color:#666; margin-top:15px; font-weight:bold;">${main.m || ''}</div>
            </div>
        `;

        // 2. ãã®ä»–ã®å€™è£œã‚’è¡¨ç¤º
        let subHtml = '';
        if (subList.length > 0) {
            subHtml = `<div style="width:100%; font-weight:bold; color:#718096; margin-top:20px;">ğŸ’¡ ã»ã‹ã«ã‚‚ ã“ã‚“ãªæ¼¢å­—ãŒ ã‚ã‚‹ã‚ˆï¼š</div>
                       <div class="other-suggestions">`;
            subList.forEach(item => {
                subHtml += `
                    <div class="suggest-card">
                        <div class="suggest-kanji">
                            <ruby>${item.kanji}<rt>${item.r}</rt></ruby>
                        </div>
                        <div class="suggest-info">
                            <div class="suggest-mean">${item.m}</div>
                        </div>
                    </div>
                `;
            });
            subHtml += `</div>`;
        }

        area.innerHTML = mainHtml + subHtml;
    }

    async function fetchReading(kanji) {
        try {
            const res = await fetch(`https://www.google.com/transliterate?langpair=ja|ja-Hira&text=${kanji}`);
            const data = await res.json();
            return data[0][1][0];
        } catch (e) { return ""; }
    }
</script>
</body>
</html>
